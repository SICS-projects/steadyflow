/* DownloadCellRenderer.c generated by valac 0.16.1, the Vala compiler
 * generated from DownloadCellRenderer.vala, do not modify */

/*
    DownloadCellRenderer.vala
    Copyright (C) 2010 Maia Kozheva <sikon@ubuntu.com>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <stdlib.h>
#include <string.h>
#include <gee.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gdk/gdk.h>
#include <cairo.h>
#include <glib/gi18n-lib.h>
#include <float.h>
#include <math.h>


#define STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER (steadyflow_ui_download_cell_renderer_get_type ())
#define STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER, SteadyflowUIDownloadCellRenderer))
#define STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER, SteadyflowUIDownloadCellRendererClass))
#define STEADYFLOW_UI_IS_DOWNLOAD_CELL_RENDERER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER))
#define STEADYFLOW_UI_IS_DOWNLOAD_CELL_RENDERER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER))
#define STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER, SteadyflowUIDownloadCellRendererClass))

typedef struct _SteadyflowUIDownloadCellRenderer SteadyflowUIDownloadCellRenderer;
typedef struct _SteadyflowUIDownloadCellRendererClass SteadyflowUIDownloadCellRendererClass;
typedef struct _SteadyflowUIDownloadCellRendererPrivate SteadyflowUIDownloadCellRendererPrivate;

#define STEADYFLOW_CORE_TYPE_IDOWNLOAD_FILE (steadyflow_core_idownload_file_get_type ())
#define STEADYFLOW_CORE_IDOWNLOAD_FILE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), STEADYFLOW_CORE_TYPE_IDOWNLOAD_FILE, SteadyflowCoreIDownloadFile))
#define STEADYFLOW_CORE_IS_IDOWNLOAD_FILE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), STEADYFLOW_CORE_TYPE_IDOWNLOAD_FILE))
#define STEADYFLOW_CORE_IDOWNLOAD_FILE_GET_INTERFACE(obj) (G_TYPE_INSTANCE_GET_INTERFACE ((obj), STEADYFLOW_CORE_TYPE_IDOWNLOAD_FILE, SteadyflowCoreIDownloadFileIface))

typedef struct _SteadyflowCoreIDownloadFile SteadyflowCoreIDownloadFile;
typedef struct _SteadyflowCoreIDownloadFileIface SteadyflowCoreIDownloadFileIface;

#define STEADYFLOW_CORE_IDOWNLOAD_FILE_TYPE_STATUS (steadyflow_core_idownload_file_status_get_type ())

#define STEADYFLOW_CORE_IDOWNLOAD_FILE_TYPE_FINISH_ACTION (steadyflow_core_idownload_file_finish_action_get_type ())
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_timer_destroy0(var) ((var == NULL) ? NULL : (var = (g_timer_destroy (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

struct _SteadyflowUIDownloadCellRenderer {
	GtkCellRenderer parent_instance;
	SteadyflowUIDownloadCellRendererPrivate * priv;
};

struct _SteadyflowUIDownloadCellRendererClass {
	GtkCellRendererClass parent_class;
};

typedef enum  {
	STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_CONNECTING = 0,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_DOWNLOADING,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_PAUSED,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_FINISHED,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_NETWORK_ERROR
} SteadyflowCoreIDownloadFileStatus;

typedef enum  {
	STEADYFLOW_CORE_IDOWNLOAD_FILE_FINISH_ACTION_DO_NOTHING = 0,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_FINISH_ACTION_OPEN_FILE,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_FINISH_ACTION_OPEN_FOLDER,
	STEADYFLOW_CORE_IDOWNLOAD_FILE_FINISH_ACTION_RUN_COMMAND
} SteadyflowCoreIDownloadFileFinishAction;

struct _SteadyflowCoreIDownloadFileIface {
	GTypeInterface parent_iface;
	void (*start) (SteadyflowCoreIDownloadFile* self, gboolean resume);
	void (*pause) (SteadyflowCoreIDownloadFile* self);
	void (*serialize) (SteadyflowCoreIDownloadFile* self, GKeyFile* file);
	SteadyflowCoreIDownloadFileStatus (*get_status) (SteadyflowCoreIDownloadFile* self);
	gint (*get_uid) (SteadyflowCoreIDownloadFile* self);
	const gchar* (*get_url) (SteadyflowCoreIDownloadFile* self);
	const gchar* (*get_local_name) (SteadyflowCoreIDownloadFile* self);
	const gchar* (*get_local_basename) (SteadyflowCoreIDownloadFile* self);
	gint64 (*get_size) (SteadyflowCoreIDownloadFile* self);
	gint64 (*get_downloaded_size) (SteadyflowCoreIDownloadFile* self);
	gint (*get_speed) (SteadyflowCoreIDownloadFile* self);
	const gchar* (*get_icon_name) (SteadyflowCoreIDownloadFile* self);
	SteadyflowCoreIDownloadFileFinishAction (*get_finish_action) (SteadyflowCoreIDownloadFile* self);
	const gchar* (*get_finish_command) (SteadyflowCoreIDownloadFile* self);
	GError* (*get_error) (SteadyflowCoreIDownloadFile* self);
};

struct _SteadyflowUIDownloadCellRendererPrivate {
	SteadyflowCoreIDownloadFile* _file;
	GtkCellRendererPixbuf* icon_renderer;
	GtkCellRendererText* text_over_renderer;
	GtkCellRendererText* text_under_renderer;
	GtkCellRendererProgress* progress_renderer;
	GTimer* timer;
	GeeMap* pirates_treasure;
};


static gpointer steadyflow_ui_download_cell_renderer_parent_class = NULL;

GType steadyflow_ui_download_cell_renderer_get_type (void) G_GNUC_CONST;
GType steadyflow_core_idownload_file_status_get_type (void) G_GNUC_CONST;
GType steadyflow_core_idownload_file_finish_action_get_type (void) G_GNUC_CONST;
GType steadyflow_core_idownload_file_get_type (void) G_GNUC_CONST;
#define STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER, SteadyflowUIDownloadCellRendererPrivate))
enum  {
	STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_DUMMY_PROPERTY,
	STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_FILE
};
#define STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_PADDING 4
#define STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE 32
static GdkPixbuf* steadyflow_ui_download_cell_renderer_get_pixbuf (SteadyflowUIDownloadCellRenderer* self, const gchar* icon_name);
SteadyflowUIDownloadCellRenderer* steadyflow_ui_download_cell_renderer_new (void);
SteadyflowUIDownloadCellRenderer* steadyflow_ui_download_cell_renderer_construct (GType object_type);
static void steadyflow_ui_download_cell_renderer_real_get_size (GtkCellRenderer* base, GtkWidget* widget, GdkRectangle* cell_area, gint* x_offset, gint* y_offset, gint* width, gint* height);
static void steadyflow_ui_download_cell_renderer_real_render (GtkCellRenderer* base, cairo_t* cr, GtkWidget* widget, GdkRectangle* background_area, GdkRectangle* cell, GtkCellRendererState flags);
static gchar* steadyflow_ui_download_cell_renderer_get_time_remaining (SteadyflowUIDownloadCellRenderer* self, gint64 file_size, gint64 downloaded_size, gint64 speed);
static gchar* steadyflow_ui_download_cell_renderer_format_file_size (SteadyflowUIDownloadCellRenderer* self, guint64 size);
SteadyflowCoreIDownloadFile* steadyflow_ui_download_cell_renderer_get_file (SteadyflowUIDownloadCellRenderer* self);
void steadyflow_ui_download_cell_renderer_set_file (SteadyflowUIDownloadCellRenderer* self, SteadyflowCoreIDownloadFile* value);
gint64 steadyflow_core_idownload_file_get_size (SteadyflowCoreIDownloadFile* self);
SteadyflowCoreIDownloadFileStatus steadyflow_core_idownload_file_get_status (SteadyflowCoreIDownloadFile* self);
gint64 steadyflow_core_idownload_file_get_downloaded_size (SteadyflowCoreIDownloadFile* self);
const gchar* steadyflow_core_idownload_file_get_local_basename (SteadyflowCoreIDownloadFile* self);
gint steadyflow_core_idownload_file_get_speed (SteadyflowCoreIDownloadFile* self);
GError* steadyflow_core_idownload_file_get_error (SteadyflowCoreIDownloadFile* self);
const gchar* steadyflow_core_idownload_file_get_icon_name (SteadyflowCoreIDownloadFile* self);
static void steadyflow_ui_download_cell_renderer_finalize (GObject* obj);
static void _vala_steadyflow_ui_download_cell_renderer_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_steadyflow_ui_download_cell_renderer_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);


static GdkPixbuf* steadyflow_ui_download_cell_renderer_get_pixbuf (SteadyflowUIDownloadCellRenderer* self, const gchar* icon_name) {
	GdkPixbuf* result = NULL;
	GdkPixbuf* pixbuf;
	const gchar* _tmp0_;
	GeeMap* _tmp1_;
	const gchar* _tmp2_;
	gboolean _tmp3_ = FALSE;
	GeeMap* _tmp14_;
	const gchar* _tmp15_;
	GdkPixbuf* _tmp16_;
	GError * _inner_error_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	g_return_val_if_fail (icon_name != NULL, NULL);
	pixbuf = NULL;
	_tmp0_ = icon_name;
	if (_tmp0_ == NULL) {
		result = NULL;
		_g_object_unref0 (pixbuf);
		return result;
	}
	_tmp1_ = self->priv->pirates_treasure;
	_tmp2_ = icon_name;
	_tmp3_ = gee_map_has_key (_tmp1_, _tmp2_);
	if (_tmp3_) {
		GeeMap* _tmp4_;
		const gchar* _tmp5_;
		gpointer _tmp6_ = NULL;
		_tmp4_ = self->priv->pirates_treasure;
		_tmp5_ = icon_name;
		_tmp6_ = gee_map_get (_tmp4_, _tmp5_);
		result = (GdkPixbuf*) _tmp6_;
		_g_object_unref0 (pixbuf);
		return result;
	}
	{
		GtkIconTheme* _tmp7_ = NULL;
		const gchar* _tmp8_;
		GdkPixbuf* _tmp9_ = NULL;
		GdkPixbuf* _tmp10_;
		_tmp7_ = gtk_icon_theme_get_default ();
		_tmp8_ = icon_name;
		_tmp9_ = gtk_icon_theme_load_icon (_tmp7_, _tmp8_, STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE, 0, &_inner_error_);
		_tmp10_ = _tmp9_;
		if (_inner_error_ != NULL) {
			goto __catch7_g_error;
		}
		_g_object_unref0 (pixbuf);
		pixbuf = _tmp10_;
	}
	goto __finally7;
	__catch7_g_error:
	{
		GError* e = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		{
			GtkIconTheme* _tmp11_ = NULL;
			GdkPixbuf* _tmp12_ = NULL;
			GdkPixbuf* _tmp13_;
			_tmp11_ = gtk_icon_theme_get_default ();
			_tmp12_ = gtk_icon_theme_load_icon (_tmp11_, GTK_STOCK_FILE, STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE, 0, &_inner_error_);
			_tmp13_ = _tmp12_;
			if (_inner_error_ != NULL) {
				goto __catch8_g_error;
			}
			_g_object_unref0 (pixbuf);
			pixbuf = _tmp13_;
		}
		goto __finally8;
		__catch8_g_error:
		{
			GError* e = NULL;
			e = _inner_error_;
			_inner_error_ = NULL;
			_g_object_unref0 (pixbuf);
			pixbuf = NULL;
			_g_error_free0 (e);
		}
		__finally8:
		if (_inner_error_ != NULL) {
			_g_error_free0 (e);
			_g_error_free0 (e);
			_g_object_unref0 (pixbuf);
			g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
		_g_error_free0 (e);
	}
	__finally7:
	if (_inner_error_ != NULL) {
		_g_object_unref0 (pixbuf);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp14_ = self->priv->pirates_treasure;
	_tmp15_ = icon_name;
	_tmp16_ = pixbuf;
	gee_map_set (_tmp14_, _tmp15_, _tmp16_);
	result = pixbuf;
	return result;
}


SteadyflowUIDownloadCellRenderer* steadyflow_ui_download_cell_renderer_construct (GType object_type) {
	SteadyflowUIDownloadCellRenderer * self = NULL;
	GeeHashMap* _tmp0_;
	GtkCellRendererPixbuf* _tmp1_;
	GtkCellRendererPixbuf* _tmp2_;
	GtkCellRendererText* _tmp3_;
	GtkCellRendererText* _tmp4_;
	GtkCellRendererText* _tmp5_;
	GtkCellRendererText* _tmp6_;
	GtkCellRendererProgress* _tmp7_;
	GtkCellRendererProgress* _tmp8_;
	GTimer* _tmp9_;
	GTimer* _tmp10_;
	self = (SteadyflowUIDownloadCellRenderer*) g_object_new (object_type, NULL);
	_tmp0_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, GDK_TYPE_PIXBUF, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL, NULL, NULL);
	_g_object_unref0 (self->priv->pirates_treasure);
	self->priv->pirates_treasure = (GeeMap*) _tmp0_;
	_tmp1_ = (GtkCellRendererPixbuf*) gtk_cell_renderer_pixbuf_new ();
	_tmp2_ = g_object_ref_sink (_tmp1_);
	_g_object_unref0 (self->priv->icon_renderer);
	self->priv->icon_renderer = _tmp2_;
	_tmp3_ = (GtkCellRendererText*) gtk_cell_renderer_text_new ();
	_tmp4_ = g_object_ref_sink (_tmp3_);
	_g_object_unref0 (self->priv->text_over_renderer);
	self->priv->text_over_renderer = _tmp4_;
	_tmp5_ = (GtkCellRendererText*) gtk_cell_renderer_text_new ();
	_tmp6_ = g_object_ref_sink (_tmp5_);
	_g_object_unref0 (self->priv->text_under_renderer);
	self->priv->text_under_renderer = _tmp6_;
	_tmp7_ = (GtkCellRendererProgress*) gtk_cell_renderer_progress_new ();
	_tmp8_ = g_object_ref_sink (_tmp7_);
	_g_object_unref0 (self->priv->progress_renderer);
	self->priv->progress_renderer = _tmp8_;
	_tmp9_ = g_timer_new ();
	_g_timer_destroy0 (self->priv->timer);
	self->priv->timer = _tmp9_;
	_tmp10_ = self->priv->timer;
	g_timer_start (_tmp10_);
	return self;
}


SteadyflowUIDownloadCellRenderer* steadyflow_ui_download_cell_renderer_new (void) {
	return steadyflow_ui_download_cell_renderer_construct (STEADYFLOW_UI_TYPE_DOWNLOAD_CELL_RENDERER);
}


static void steadyflow_ui_download_cell_renderer_real_get_size (GtkCellRenderer* base, GtkWidget* widget, GdkRectangle* cell_area, gint* x_offset, gint* y_offset, gint* width, gint* height) {
	SteadyflowUIDownloadCellRenderer * self;
	gint _vala_x_offset = 0;
	gint _vala_y_offset = 0;
	gint _vala_width = 0;
	gint _vala_height = 0;
	gint textheight_over = 0;
	gint textheight_under = 0;
	GtkCellRendererText* _tmp0_;
	GtkWidget* _tmp1_;
	gint _tmp2_ = 0;
	GtkCellRendererText* _tmp3_;
	GtkWidget* _tmp4_;
	gint _tmp5_ = 0;
	GtkCellRendererProgress* _tmp6_;
	GtkWidget* _tmp7_;
	GdkRectangle* _tmp8_;
	gint _tmp9_ = 0;
	gint _tmp10_ = 0;
	gint _tmp11_ = 0;
	gint _tmp12_ = 0;
	gint _tmp13_;
	self = (SteadyflowUIDownloadCellRenderer*) base;
	g_return_if_fail (widget != NULL);
	_tmp0_ = self->priv->text_over_renderer;
	_tmp1_ = widget;
	gtk_cell_renderer_get_size ((GtkCellRenderer*) _tmp0_, _tmp1_, NULL, NULL, NULL, NULL, &_tmp2_);
	textheight_over = _tmp2_;
	_tmp3_ = self->priv->text_under_renderer;
	_tmp4_ = widget;
	gtk_cell_renderer_get_size ((GtkCellRenderer*) _tmp3_, _tmp4_, NULL, NULL, NULL, NULL, &_tmp5_);
	textheight_under = _tmp5_;
	_tmp6_ = self->priv->progress_renderer;
	_tmp7_ = widget;
	_tmp8_ = cell_area;
	gtk_cell_renderer_get_size ((GtkCellRenderer*) _tmp6_, _tmp7_, _tmp8_, &_tmp9_, &_tmp10_, &_tmp11_, &_tmp12_);
	_vala_x_offset = _tmp9_;
	_vala_y_offset = _tmp10_;
	_vala_width = _tmp11_;
	_vala_height = _tmp12_;
	_tmp13_ = _vala_height;
	_vala_height = (((2 * STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_PADDING) + textheight_over) + _tmp13_) + textheight_under;
	if (x_offset) {
		*x_offset = _vala_x_offset;
	}
	if (y_offset) {
		*y_offset = _vala_y_offset;
	}
	if (width) {
		*width = _vala_width;
	}
	if (height) {
		*height = _vala_height;
	}
}


static void steadyflow_ui_download_cell_renderer_real_render (GtkCellRenderer* base, cairo_t* cr, GtkWidget* widget, GdkRectangle* background_area, GdkRectangle* cell, GtkCellRendererState flags) {
	SteadyflowUIDownloadCellRenderer * self;
	gint textheight_over = 0;
	gint textheight_under = 0;
	gint progressheight = 0;
	GdkRectangle _tmp0_;
	gint _tmp1_;
	gint x;
	GdkRectangle _tmp2_;
	gint _tmp3_;
	gint y;
	GdkRectangle _tmp4_;
	gint _tmp5_;
	gint width;
	GtkCellRendererText* _tmp6_;
	GtkWidget* _tmp7_;
	gint _tmp8_ = 0;
	GtkCellRendererText* _tmp9_;
	GtkWidget* _tmp10_;
	gint _tmp11_ = 0;
	GtkCellRendererProgress* _tmp12_;
	GtkWidget* _tmp13_;
	gint _tmp14_ = 0;
	GdkRectangle _tmp15_;
	gint _tmp16_;
	GdkRectangle _tmp17_;
	gint _tmp18_;
	GdkRectangle _tmp19_;
	gint _tmp20_;
	GdkRectangle _tmp21_ = {0};
	GdkRectangle icon_rect;
	GdkRectangle _tmp22_ = {0};
	GdkRectangle text_over_rect;
	GdkRectangle _tmp23_;
	gint _tmp24_;
	GdkRectangle _tmp25_ = {0};
	GdkRectangle progress_rect;
	GdkRectangle _tmp26_;
	gint _tmp27_;
	GdkRectangle _tmp28_;
	gint _tmp29_;
	GdkRectangle _tmp30_ = {0};
	GdkRectangle text_under_rect;
	GtkCellRendererPixbuf* _tmp31_;
	cairo_t* _tmp32_;
	GtkWidget* _tmp33_;
	GdkRectangle _tmp34_;
	GdkRectangle _tmp35_;
	GtkCellRendererState _tmp36_;
	GtkCellRendererText* _tmp37_;
	cairo_t* _tmp38_;
	GtkWidget* _tmp39_;
	GdkRectangle _tmp40_;
	GdkRectangle _tmp41_;
	GtkCellRendererState _tmp42_;
	GtkCellRendererProgress* _tmp43_;
	cairo_t* _tmp44_;
	GtkWidget* _tmp45_;
	GdkRectangle _tmp46_;
	GdkRectangle _tmp47_;
	GtkCellRendererState _tmp48_;
	GtkCellRendererText* _tmp49_;
	cairo_t* _tmp50_;
	GtkWidget* _tmp51_;
	GdkRectangle _tmp52_;
	GdkRectangle _tmp53_;
	GtkCellRendererState _tmp54_;
	self = (SteadyflowUIDownloadCellRenderer*) base;
	g_return_if_fail (cr != NULL);
	g_return_if_fail (widget != NULL);
	g_return_if_fail (background_area != NULL);
	g_return_if_fail (cell != NULL);
	_tmp0_ = *cell;
	_tmp1_ = _tmp0_.x;
	x = (_tmp1_ + (2 * STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_PADDING)) + STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE;
	_tmp2_ = *cell;
	_tmp3_ = _tmp2_.y;
	y = _tmp3_ + STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_PADDING;
	_tmp4_ = *cell;
	_tmp5_ = _tmp4_.width;
	width = (_tmp5_ - x) - STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_PADDING;
	_tmp6_ = self->priv->text_over_renderer;
	_tmp7_ = widget;
	gtk_cell_renderer_get_size ((GtkCellRenderer*) _tmp6_, _tmp7_, NULL, NULL, NULL, NULL, &_tmp8_);
	textheight_over = _tmp8_;
	_tmp9_ = self->priv->text_under_renderer;
	_tmp10_ = widget;
	gtk_cell_renderer_get_size ((GtkCellRenderer*) _tmp9_, _tmp10_, NULL, NULL, NULL, NULL, &_tmp11_);
	textheight_under = _tmp11_;
	_tmp12_ = self->priv->progress_renderer;
	_tmp13_ = widget;
	gtk_cell_renderer_get_size ((GtkCellRenderer*) _tmp12_, _tmp13_, NULL, NULL, NULL, NULL, &_tmp14_);
	progressheight = _tmp14_;
	_tmp15_ = *cell;
	_tmp16_ = _tmp15_.x;
	_tmp17_ = *cell;
	_tmp18_ = _tmp17_.y;
	_tmp19_ = *cell;
	_tmp20_ = _tmp19_.height;
	memset (&_tmp21_, 0, sizeof (GdkRectangle));
	_tmp21_.x = _tmp16_ + STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_PADDING;
	_tmp21_.y = _tmp18_ + ((_tmp20_ - STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE) / 2);
	_tmp21_.width = STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE;
	_tmp21_.height = STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_ICON_SIZE;
	icon_rect = _tmp21_;
	memset (&_tmp22_, 0, sizeof (GdkRectangle));
	_tmp22_.x = x;
	_tmp22_.y = y;
	_tmp22_.width = width;
	_tmp22_.height = textheight_over;
	text_over_rect = _tmp22_;
	_tmp23_ = text_over_rect;
	_tmp24_ = _tmp23_.height;
	memset (&_tmp25_, 0, sizeof (GdkRectangle));
	_tmp25_.x = x;
	_tmp25_.y = y + _tmp24_;
	_tmp25_.width = width;
	_tmp25_.height = progressheight;
	progress_rect = _tmp25_;
	_tmp26_ = progress_rect;
	_tmp27_ = _tmp26_.y;
	_tmp28_ = progress_rect;
	_tmp29_ = _tmp28_.height;
	memset (&_tmp30_, 0, sizeof (GdkRectangle));
	_tmp30_.x = x;
	_tmp30_.y = _tmp27_ + _tmp29_;
	_tmp30_.width = width;
	_tmp30_.height = textheight_under;
	text_under_rect = _tmp30_;
	_tmp31_ = self->priv->icon_renderer;
	_tmp32_ = cr;
	_tmp33_ = widget;
	_tmp34_ = icon_rect;
	_tmp35_ = icon_rect;
	_tmp36_ = flags;
	gtk_cell_renderer_render ((GtkCellRenderer*) _tmp31_, _tmp32_, _tmp33_, &_tmp34_, &_tmp35_, _tmp36_);
	_tmp37_ = self->priv->text_over_renderer;
	_tmp38_ = cr;
	_tmp39_ = widget;
	_tmp40_ = text_over_rect;
	_tmp41_ = text_over_rect;
	_tmp42_ = flags;
	gtk_cell_renderer_render ((GtkCellRenderer*) _tmp37_, _tmp38_, _tmp39_, &_tmp40_, &_tmp41_, _tmp42_);
	_tmp43_ = self->priv->progress_renderer;
	_tmp44_ = cr;
	_tmp45_ = widget;
	_tmp46_ = progress_rect;
	_tmp47_ = progress_rect;
	_tmp48_ = flags;
	gtk_cell_renderer_render ((GtkCellRenderer*) _tmp43_, _tmp44_, _tmp45_, &_tmp46_, &_tmp47_, _tmp48_);
	_tmp49_ = self->priv->text_under_renderer;
	_tmp50_ = cr;
	_tmp51_ = widget;
	_tmp52_ = text_under_rect;
	_tmp53_ = text_under_rect;
	_tmp54_ = flags;
	gtk_cell_renderer_render ((GtkCellRenderer*) _tmp49_, _tmp50_, _tmp51_, &_tmp52_, &_tmp53_, _tmp54_);
}


static gchar* steadyflow_ui_download_cell_renderer_get_time_remaining (SteadyflowUIDownloadCellRenderer* self, gint64 file_size, gint64 downloaded_size, gint64 speed) {
	gchar* result = NULL;
	gint64 _tmp0_;
	gint64 _tmp3_;
	gint64 _tmp4_;
	gint64 _tmp7_;
	gint64 _tmp8_;
	gint64 size_remaining;
	gint64 _tmp9_;
	gint64 _tmp10_;
	gint64 seconds;
	gint64 _tmp11_;
	gint64 _tmp16_;
	gint64 minutes;
	gint64 _tmp17_;
	gint64 _tmp22_;
	gint64 hours;
	gint64 _tmp23_;
	gint64 _tmp24_;
	gint64 _tmp35_;
	gint64 days;
	gint64 _tmp36_;
	gint64 _tmp37_;
	const gchar* _tmp38_ = NULL;
	gint64 _tmp39_;
	const gchar* _tmp40_ = NULL;
	gint64 _tmp41_;
	gchar* _tmp42_ = NULL;
	gchar* _tmp43_;
	gint64 _tmp44_;
	gchar* _tmp45_ = NULL;
	gchar* _tmp46_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = speed;
	if (_tmp0_ <= ((gint64) 0)) {
		const gchar* _tmp1_ = NULL;
		gchar* _tmp2_;
		_tmp1_ = _ ("unknown time remaining");
		_tmp2_ = g_strdup (_tmp1_);
		result = _tmp2_;
		return result;
	}
	_tmp3_ = file_size;
	_tmp4_ = downloaded_size;
	if (_tmp3_ <= _tmp4_) {
		const gchar* _tmp5_ = NULL;
		gchar* _tmp6_;
		_tmp5_ = _ ("a few seconds remaining");
		_tmp6_ = g_strdup (_tmp5_);
		result = _tmp6_;
		return result;
	}
	_tmp7_ = file_size;
	_tmp8_ = downloaded_size;
	size_remaining = _tmp7_ - _tmp8_;
	_tmp9_ = size_remaining;
	_tmp10_ = speed;
	seconds = _tmp9_ / _tmp10_;
	_tmp11_ = seconds;
	if (_tmp11_ < ((gint64) 60)) {
		gint64 _tmp12_;
		const gchar* _tmp13_ = NULL;
		gint64 _tmp14_;
		gchar* _tmp15_ = NULL;
		_tmp12_ = seconds;
		_tmp13_ = ngettext ("%d second remaining", "%d seconds remaining", (gulong) ((gint) _tmp12_));
		_tmp14_ = seconds;
		_tmp15_ = g_strdup_printf (_tmp13_, (gint) _tmp14_);
		result = _tmp15_;
		return result;
	}
	_tmp16_ = seconds;
	minutes = _tmp16_ / 60;
	_tmp17_ = minutes;
	if (_tmp17_ < ((gint64) 60)) {
		gint64 _tmp18_;
		const gchar* _tmp19_ = NULL;
		gint64 _tmp20_;
		gchar* _tmp21_ = NULL;
		_tmp18_ = minutes;
		_tmp19_ = ngettext ("%d minute remaining", "%d minutes remaining", (gulong) ((gint) _tmp18_));
		_tmp20_ = minutes;
		_tmp21_ = g_strdup_printf (_tmp19_, (gint) _tmp20_);
		result = _tmp21_;
		return result;
	}
	_tmp22_ = minutes;
	hours = _tmp22_ / 60;
	_tmp23_ = minutes;
	minutes = _tmp23_ % 60;
	_tmp24_ = hours;
	if (_tmp24_ < ((gint64) 24)) {
		gint64 _tmp25_;
		const gchar* _tmp26_ = NULL;
		gint64 _tmp27_;
		const gchar* _tmp28_ = NULL;
		gint64 _tmp29_;
		gchar* _tmp30_ = NULL;
		gchar* _tmp31_;
		gint64 _tmp32_;
		gchar* _tmp33_ = NULL;
		gchar* _tmp34_;
		_tmp25_ = minutes;
		_tmp26_ = ngettext ("%s, %d minute remaining", "%s, %d minutes remaining", (gulong) ((gint) _tmp25_));
		_tmp27_ = hours;
		_tmp28_ = ngettext ("%d hour", "%d hours", (gulong) ((gint) _tmp27_));
		_tmp29_ = hours;
		_tmp30_ = g_strdup_printf (_tmp28_, (gint) _tmp29_);
		_tmp31_ = _tmp30_;
		_tmp32_ = minutes;
		_tmp33_ = g_strdup_printf (_tmp26_, _tmp31_, (gint) _tmp32_);
		_tmp34_ = _tmp33_;
		_g_free0 (_tmp31_);
		result = _tmp34_;
		return result;
	}
	_tmp35_ = hours;
	days = _tmp35_ / 24;
	_tmp36_ = hours;
	hours = _tmp36_ % 24;
	_tmp37_ = hours;
	_tmp38_ = ngettext ("%s, %d hour remaining", "%s, %d hour remaining", (gulong) ((gint) _tmp37_));
	_tmp39_ = days;
	_tmp40_ = ngettext ("%d day", "%d days", (gulong) ((gint) _tmp39_));
	_tmp41_ = days;
	_tmp42_ = g_strdup_printf (_tmp40_, (gint) _tmp41_);
	_tmp43_ = _tmp42_;
	_tmp44_ = hours;
	_tmp45_ = g_strdup_printf (_tmp38_, _tmp43_, (gint) _tmp44_);
	_tmp46_ = _tmp45_;
	_g_free0 (_tmp43_);
	result = _tmp46_;
	return result;
}


static gchar* steadyflow_ui_download_cell_renderer_format_file_size (SteadyflowUIDownloadCellRenderer* self, guint64 size) {
	gchar* result = NULL;
	guint64 _tmp0_;
	gchar* _tmp1_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = size;
	_tmp1_ = g_format_size_full (_tmp0_, G_FORMAT_SIZE_IEC_UNITS);
	result = _tmp1_;
	return result;
}


SteadyflowCoreIDownloadFile* steadyflow_ui_download_cell_renderer_get_file (SteadyflowUIDownloadCellRenderer* self) {
	SteadyflowCoreIDownloadFile* result;
	SteadyflowCoreIDownloadFile* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_file;
	result = _tmp0_;
	return result;
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


void steadyflow_ui_download_cell_renderer_set_file (SteadyflowUIDownloadCellRenderer* self, SteadyflowCoreIDownloadFile* value) {
	SteadyflowCoreIDownloadFile* _tmp0_;
	SteadyflowCoreIDownloadFile* _tmp1_;
	SteadyflowCoreIDownloadFile* _tmp2_;
	gint64 _tmp3_;
	gint64 _tmp4_;
	GtkCellRendererText* _tmp53_;
	SteadyflowCoreIDownloadFile* _tmp54_;
	const gchar* _tmp55_;
	const gchar* _tmp56_;
	gchar* _tmp57_ = NULL;
	gchar* _tmp58_;
	SteadyflowCoreIDownloadFile* _tmp59_;
	SteadyflowCoreIDownloadFileStatus _tmp60_;
	SteadyflowCoreIDownloadFileStatus _tmp61_;
	GtkCellRendererPixbuf* _tmp107_;
	SteadyflowCoreIDownloadFile* _tmp108_;
	const gchar* _tmp109_;
	const gchar* _tmp110_;
	GdkPixbuf* _tmp111_ = NULL;
	GdkPixbuf* _tmp112_;
	g_return_if_fail (self != NULL);
	_tmp0_ = value;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (self->priv->_file);
	self->priv->_file = _tmp1_;
	_tmp2_ = self->priv->_file;
	_tmp3_ = steadyflow_core_idownload_file_get_size (_tmp2_);
	_tmp4_ = _tmp3_;
	if (_tmp4_ == ((gint64) 0)) {
		SteadyflowCoreIDownloadFile* _tmp5_;
		SteadyflowCoreIDownloadFileStatus _tmp6_;
		SteadyflowCoreIDownloadFileStatus _tmp7_;
		gint _tmp12_ = 0;
		SteadyflowCoreIDownloadFile* _tmp13_;
		SteadyflowCoreIDownloadFileStatus _tmp14_;
		SteadyflowCoreIDownloadFileStatus _tmp15_;
		GtkCellRendererProgress* _tmp16_;
		gint _tmp17_;
		GtkCellRendererProgress* _tmp18_;
		const gchar* _tmp19_ = NULL;
		SteadyflowCoreIDownloadFile* _tmp20_;
		gint64 _tmp21_;
		gint64 _tmp22_;
		gchar* _tmp23_ = NULL;
		gchar* _tmp24_;
		gchar* _tmp25_ = NULL;
		gchar* _tmp26_;
		_tmp5_ = self->priv->_file;
		_tmp6_ = steadyflow_core_idownload_file_get_status (_tmp5_);
		_tmp7_ = _tmp6_;
		if (_tmp7_ != STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_DOWNLOADING) {
			GtkCellRendererProgress* _tmp8_;
			_tmp8_ = self->priv->progress_renderer;
			g_object_set (_tmp8_, "pulse", -1, NULL);
		} else {
			GtkCellRendererProgress* _tmp9_;
			GTimer* _tmp10_;
			gdouble _tmp11_ = 0.0;
			_tmp9_ = self->priv->progress_renderer;
			_tmp10_ = self->priv->timer;
			_tmp11_ = g_timer_elapsed (_tmp10_, NULL);
			g_object_set (_tmp9_, "pulse", (((gint) ((guint) (_tmp11_ * 5))) % 100000) + 1, NULL);
		}
		_tmp13_ = self->priv->_file;
		_tmp14_ = steadyflow_core_idownload_file_get_status (_tmp13_);
		_tmp15_ = _tmp14_;
		if (_tmp15_ == STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_FINISHED) {
			_tmp12_ = 100;
		} else {
			_tmp12_ = 0;
		}
		_tmp16_ = self->priv->progress_renderer;
		_tmp17_ = _tmp12_;
		g_object_set (_tmp16_, "value", _tmp17_, NULL);
		_tmp18_ = self->priv->progress_renderer;
		_tmp19_ = _ ("%s downloaded");
		_tmp20_ = self->priv->_file;
		_tmp21_ = steadyflow_core_idownload_file_get_downloaded_size (_tmp20_);
		_tmp22_ = _tmp21_;
		_tmp23_ = steadyflow_ui_download_cell_renderer_format_file_size (self, (guint64) _tmp22_);
		_tmp24_ = _tmp23_;
		_tmp25_ = g_strdup_printf (_tmp19_, _tmp24_);
		_tmp26_ = _tmp25_;
		g_object_set (_tmp18_, "text", _tmp26_, NULL);
		_g_free0 (_tmp26_);
		_g_free0 (_tmp24_);
	} else {
		GtkCellRendererProgress* _tmp27_;
		SteadyflowCoreIDownloadFile* _tmp28_;
		gint64 _tmp29_;
		gint64 _tmp30_;
		SteadyflowCoreIDownloadFile* _tmp31_;
		gint64 _tmp32_;
		gint64 _tmp33_;
		gint progress;
		GtkCellRendererProgress* _tmp34_;
		gint _tmp35_;
		GtkCellRendererProgress* _tmp36_;
		const gchar* _tmp37_ = NULL;
		gchar* _tmp38_;
		gchar* _tmp39_;
		SteadyflowCoreIDownloadFile* _tmp40_;
		gint64 _tmp41_;
		gint64 _tmp42_;
		gchar* _tmp43_ = NULL;
		gchar* _tmp44_;
		SteadyflowCoreIDownloadFile* _tmp45_;
		gint64 _tmp46_;
		gint64 _tmp47_;
		gchar* _tmp48_ = NULL;
		gchar* _tmp49_;
		gint _tmp50_;
		gchar* _tmp51_ = NULL;
		gchar* _tmp52_;
		_tmp27_ = self->priv->progress_renderer;
		g_object_set (_tmp27_, "pulse", -1, NULL);
		_tmp28_ = self->priv->_file;
		_tmp29_ = steadyflow_core_idownload_file_get_downloaded_size (_tmp28_);
		_tmp30_ = _tmp29_;
		_tmp31_ = self->priv->_file;
		_tmp32_ = steadyflow_core_idownload_file_get_size (_tmp31_);
		_tmp33_ = _tmp32_;
		progress = (gint) ((((gdouble) _tmp30_) / _tmp33_) * 100);
		_tmp34_ = self->priv->progress_renderer;
		_tmp35_ = progress;
		g_object_set (_tmp34_, "value", _tmp35_, NULL);
		_tmp36_ = self->priv->progress_renderer;
		_tmp37_ = _ ("%s of %s downloaded");
		_tmp38_ = g_strconcat (_tmp37_, " (%d%%)", NULL);
		_tmp39_ = _tmp38_;
		_tmp40_ = self->priv->_file;
		_tmp41_ = steadyflow_core_idownload_file_get_downloaded_size (_tmp40_);
		_tmp42_ = _tmp41_;
		_tmp43_ = steadyflow_ui_download_cell_renderer_format_file_size (self, (guint64) _tmp42_);
		_tmp44_ = _tmp43_;
		_tmp45_ = self->priv->_file;
		_tmp46_ = steadyflow_core_idownload_file_get_size (_tmp45_);
		_tmp47_ = _tmp46_;
		_tmp48_ = steadyflow_ui_download_cell_renderer_format_file_size (self, (guint64) _tmp47_);
		_tmp49_ = _tmp48_;
		_tmp50_ = progress;
		_tmp51_ = g_strdup_printf (_tmp39_, _tmp44_, _tmp49_, _tmp50_);
		_tmp52_ = _tmp51_;
		g_object_set (_tmp36_, "text", _tmp52_, NULL);
		_g_free0 (_tmp52_);
		_g_free0 (_tmp49_);
		_g_free0 (_tmp44_);
		_g_free0 (_tmp39_);
	}
	_tmp53_ = self->priv->text_over_renderer;
	_tmp54_ = self->priv->_file;
	_tmp55_ = steadyflow_core_idownload_file_get_local_basename (_tmp54_);
	_tmp56_ = _tmp55_;
	_tmp57_ = g_markup_printf_escaped ("<span weight='bold' size='larger'>%s</span>", _tmp56_);
	_tmp58_ = _tmp57_;
	g_object_set (_tmp53_, "markup", _tmp58_, NULL);
	_g_free0 (_tmp58_);
	_tmp59_ = self->priv->_file;
	_tmp60_ = steadyflow_core_idownload_file_get_status (_tmp59_);
	_tmp61_ = _tmp60_;
	switch (_tmp61_) {
		case STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_DOWNLOADING:
		{
			SteadyflowCoreIDownloadFile* _tmp62_;
			gint64 _tmp63_;
			gint64 _tmp64_;
			SteadyflowCoreIDownloadFile* _tmp65_;
			gint64 _tmp66_;
			gint64 _tmp67_;
			SteadyflowCoreIDownloadFile* _tmp68_;
			gint _tmp69_;
			gint _tmp70_;
			gchar* _tmp71_ = NULL;
			gchar* time_str;
			GtkCellRendererText* _tmp72_;
			const gchar* _tmp73_ = NULL;
			SteadyflowCoreIDownloadFile* _tmp74_;
			gint _tmp75_;
			gint _tmp76_;
			gchar* _tmp77_ = NULL;
			gchar* _tmp78_;
			gchar* _tmp79_ = NULL;
			gchar* _tmp80_;
			const gchar* _tmp81_;
			gchar* _tmp82_ = NULL;
			gchar* _tmp83_;
			gchar* _tmp84_;
			gchar* _tmp85_;
			_tmp62_ = self->priv->_file;
			_tmp63_ = steadyflow_core_idownload_file_get_size (_tmp62_);
			_tmp64_ = _tmp63_;
			_tmp65_ = self->priv->_file;
			_tmp66_ = steadyflow_core_idownload_file_get_downloaded_size (_tmp65_);
			_tmp67_ = _tmp66_;
			_tmp68_ = self->priv->_file;
			_tmp69_ = steadyflow_core_idownload_file_get_speed (_tmp68_);
			_tmp70_ = _tmp69_;
			_tmp71_ = steadyflow_ui_download_cell_renderer_get_time_remaining (self, _tmp64_, _tmp67_, (gint64) _tmp70_);
			time_str = _tmp71_;
			_tmp72_ = self->priv->text_under_renderer;
			_tmp73_ = _ ("Downloading at speed %s/s");
			_tmp74_ = self->priv->_file;
			_tmp75_ = steadyflow_core_idownload_file_get_speed (_tmp74_);
			_tmp76_ = _tmp75_;
			_tmp77_ = steadyflow_ui_download_cell_renderer_format_file_size (self, (guint64) _tmp76_);
			_tmp78_ = _tmp77_;
			_tmp79_ = g_strdup_printf (_tmp73_, _tmp78_);
			_tmp80_ = _tmp79_;
			_tmp81_ = time_str;
			_tmp82_ = g_strdup_printf (" (%s)", _tmp81_);
			_tmp83_ = _tmp82_;
			_tmp84_ = g_strconcat (_tmp80_, _tmp83_, NULL);
			_tmp85_ = _tmp84_;
			g_object_set (_tmp72_, "text", _tmp85_, NULL);
			_g_free0 (_tmp85_);
			_g_free0 (_tmp83_);
			_g_free0 (_tmp80_);
			_g_free0 (_tmp78_);
			_g_free0 (time_str);
			break;
		}
		case STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_CONNECTING:
		{
			GtkCellRendererText* _tmp86_;
			const gchar* _tmp87_ = NULL;
			_tmp86_ = self->priv->text_under_renderer;
			_tmp87_ = _ ("Connecting...");
			g_object_set (_tmp86_, "text", _tmp87_, NULL);
			break;
		}
		case STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_PAUSED:
		{
			GtkCellRendererText* _tmp88_;
			const gchar* _tmp89_ = NULL;
			_tmp88_ = self->priv->text_under_renderer;
			_tmp89_ = _ ("Download paused");
			g_object_set (_tmp88_, "text", _tmp89_, NULL);
			break;
		}
		case STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_FINISHED:
		{
			GtkCellRendererText* _tmp90_;
			const gchar* _tmp91_ = NULL;
			_tmp90_ = self->priv->text_under_renderer;
			_tmp91_ = _ ("Download finished");
			g_object_set (_tmp90_, "text", _tmp91_, NULL);
			break;
		}
		case STEADYFLOW_CORE_IDOWNLOAD_FILE_STATUS_NETWORK_ERROR:
		{
			const gchar* _tmp92_ = NULL;
			gchar* _tmp93_;
			gchar* text;
			SteadyflowCoreIDownloadFile* _tmp94_;
			GError* _tmp95_;
			GError* _tmp96_;
			GtkCellRendererText* _tmp105_;
			const gchar* _tmp106_;
			_tmp92_ = _ ("Download stopped: network error");
			_tmp93_ = g_strdup (_tmp92_);
			text = _tmp93_;
			_tmp94_ = self->priv->_file;
			_tmp95_ = steadyflow_core_idownload_file_get_error (_tmp94_);
			_tmp96_ = _tmp95_;
			if (_tmp96_ != NULL) {
				const gchar* _tmp97_;
				SteadyflowCoreIDownloadFile* _tmp98_;
				GError* _tmp99_;
				GError* _tmp100_;
				const gchar* _tmp101_;
				gchar* _tmp102_ = NULL;
				gchar* _tmp103_;
				gchar* _tmp104_;
				_tmp97_ = text;
				_tmp98_ = self->priv->_file;
				_tmp99_ = steadyflow_core_idownload_file_get_error (_tmp98_);
				_tmp100_ = _tmp99_;
				_tmp101_ = _tmp100_->message;
				_tmp102_ = g_strdup_printf (" (%s)", _tmp101_);
				_tmp103_ = _tmp102_;
				_tmp104_ = g_strconcat (_tmp97_, _tmp103_, NULL);
				_g_free0 (text);
				text = _tmp104_;
				_g_free0 (_tmp103_);
			}
			_tmp105_ = self->priv->text_under_renderer;
			_tmp106_ = text;
			g_object_set (_tmp105_, "text", _tmp106_, NULL);
			_g_free0 (text);
			break;
		}
		default:
		break;
	}
	_tmp107_ = self->priv->icon_renderer;
	_tmp108_ = self->priv->_file;
	_tmp109_ = steadyflow_core_idownload_file_get_icon_name (_tmp108_);
	_tmp110_ = _tmp109_;
	_tmp111_ = steadyflow_ui_download_cell_renderer_get_pixbuf (self, _tmp110_);
	_tmp112_ = _tmp111_;
	g_object_set (_tmp107_, "pixbuf", _tmp112_, NULL);
	_g_object_unref0 (_tmp112_);
	g_object_notify ((GObject *) self, "file");
}


static void steadyflow_ui_download_cell_renderer_class_init (SteadyflowUIDownloadCellRendererClass * klass) {
	steadyflow_ui_download_cell_renderer_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (SteadyflowUIDownloadCellRendererPrivate));
	GTK_CELL_RENDERER_CLASS (klass)->get_size = steadyflow_ui_download_cell_renderer_real_get_size;
	GTK_CELL_RENDERER_CLASS (klass)->render = steadyflow_ui_download_cell_renderer_real_render;
	G_OBJECT_CLASS (klass)->get_property = _vala_steadyflow_ui_download_cell_renderer_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_steadyflow_ui_download_cell_renderer_set_property;
	G_OBJECT_CLASS (klass)->finalize = steadyflow_ui_download_cell_renderer_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_FILE, g_param_spec_object ("file", "file", "file", STEADYFLOW_CORE_TYPE_IDOWNLOAD_FILE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
}


static void steadyflow_ui_download_cell_renderer_instance_init (SteadyflowUIDownloadCellRenderer * self) {
	self->priv = STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_GET_PRIVATE (self);
}


static void steadyflow_ui_download_cell_renderer_finalize (GObject* obj) {
	SteadyflowUIDownloadCellRenderer * self;
	self = STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER (obj);
	_g_object_unref0 (self->priv->_file);
	_g_object_unref0 (self->priv->icon_renderer);
	_g_object_unref0 (self->priv->text_over_renderer);
	_g_object_unref0 (self->priv->text_under_renderer);
	_g_object_unref0 (self->priv->progress_renderer);
	_g_timer_destroy0 (self->priv->timer);
	_g_object_unref0 (self->priv->pirates_treasure);
	G_OBJECT_CLASS (steadyflow_ui_download_cell_renderer_parent_class)->finalize (obj);
}


GType steadyflow_ui_download_cell_renderer_get_type (void) {
	static volatile gsize steadyflow_ui_download_cell_renderer_type_id__volatile = 0;
	if (g_once_init_enter (&steadyflow_ui_download_cell_renderer_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (SteadyflowUIDownloadCellRendererClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) steadyflow_ui_download_cell_renderer_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (SteadyflowUIDownloadCellRenderer), 0, (GInstanceInitFunc) steadyflow_ui_download_cell_renderer_instance_init, NULL };
		GType steadyflow_ui_download_cell_renderer_type_id;
		steadyflow_ui_download_cell_renderer_type_id = g_type_register_static (GTK_TYPE_CELL_RENDERER, "SteadyflowUIDownloadCellRenderer", &g_define_type_info, 0);
		g_once_init_leave (&steadyflow_ui_download_cell_renderer_type_id__volatile, steadyflow_ui_download_cell_renderer_type_id);
	}
	return steadyflow_ui_download_cell_renderer_type_id__volatile;
}


static void _vala_steadyflow_ui_download_cell_renderer_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	SteadyflowUIDownloadCellRenderer * self;
	self = STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER (object);
	switch (property_id) {
		case STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_FILE:
		g_value_set_object (value, steadyflow_ui_download_cell_renderer_get_file (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_steadyflow_ui_download_cell_renderer_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	SteadyflowUIDownloadCellRenderer * self;
	self = STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER (object);
	switch (property_id) {
		case STEADYFLOW_UI_DOWNLOAD_CELL_RENDERER_FILE:
		steadyflow_ui_download_cell_renderer_set_file (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}



